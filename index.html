<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>System_Boot_Bordi.exe</title> 
    
    <!-- Fonts & Libraries (Keep exactly as before) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;800&family=Great+Vibes&family=Lato:wght@300;400&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/TextPlugin.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/Draggable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <!-- Tailwind Config (Same as before) -->
    <script>
        tailwind.config = { theme: { extend: { fontFamily: { 'royal': ['Cinzel', 'serif'], 'script': ['Great Vibes', 'cursive'], 'body': ['Lato', 'sans-serif'], 'tech': ['Share Tech Mono', 'monospace'], }, colors: { 'deep-void': '#050203', 'rose-gold': '#e11d48', 'pale-gold': '#fce7f3' } } } }
    </script>

    <!-- Styles (Same as before) -->
    <style>
        body { margin: 0; overflow: hidden; background-color: #050203; font-family: 'Lato', sans-serif; color: #fce7f3; user-select: none; -webkit-tap-highlight-color: transparent; }
        .vignette { position: fixed; inset: 0; pointer-events: none; z-index: 2; background: radial-gradient(circle, transparent 40%, rgba(0,0,0,0.8) 100%); }
        .noise { position: fixed; inset: 0; pointer-events: none; z-index: 3; opacity: 0.04; background-image: url("https://grainy-gradients.vercel.app/noise.svg"); filter: contrast(150%) brightness(100%); }
        .glitch-active { animation: glitch-anim 0.2s infinite; }
        @keyframes glitch-anim { 0% { transform: translate(0) } 20% { transform: translate(-2px, 2px) } 40% { transform: translate(-2px, -2px) } 60% { transform: translate(2px, 2px) } 80% { transform: translate(2px, -2px) } 100% { transform: translate(0) } }
        .breathe { animation: breathe 6s ease-in-out infinite; }
        @keyframes breathe { 0%, 100% { opacity: 0.7; transform: scale(1); } 50% { opacity: 1; transform: scale(1.05); } }
        .glass-panel { width: 100%; height: 100vh; position: relative; overflow: hidden; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .chapter-container { position: absolute; inset: 0; padding: 1.5rem; display: flex; flex-direction: column; align-items: center; justify-content: center; opacity: 0; visibility: hidden; text-align: center; z-index: 10; pointer-events: none; transition: opacity 0.5s ease; }
        .chapter-active { opacity: 1; visibility: visible; z-index: 20; pointer-events: auto; }
        .majestic-btn { background: transparent; border: 1px solid rgba(255,255,255,0.3); color: white; padding: 14px 30px; font-family: 'Cinzel', serif; font-size: 0.8rem; letter-spacing: 3px; text-transform: uppercase; transition: all 0.6s ease; margin-top: 30px; cursor: pointer; position: relative; overflow: hidden; pointer-events: auto; z-index: 50; border-radius: 4px; }
        .majestic-btn:hover { background: rgba(225, 29, 72, 0.1); border-color: #fda4af; box-shadow: 0 0 40px rgba(225, 29, 72, 0.3); }
        .tech-btn { font-family: 'Share Tech Mono', monospace; background: rgba(0, 255, 0, 0.1); border: 1px solid #0f0; color: #0f0; padding: 10px 25px; text-transform: uppercase; cursor: pointer; letter-spacing: 2px; transition: all 0.3s; margin-top: 20px; font-size: 0.9rem; }
        .tech-btn:hover { background: #0f0; color: black; box-shadow: 0 0 15px #0f0; }
        .gold-text { background: linear-gradient(to bottom, #fff 0%, #fbcfe8 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; text-shadow: 0 0 30px rgba(255,192,203,0.3); }
        .smile-sensor { width: 100px; height: 100px; border-radius: 50%; border: 2px solid rgba(255,255,255,0.1); display: flex; align-items: center; justify-content: center; font-size: 3rem; cursor: pointer; transition: all 0.5s; animation: pulse-border 2s infinite; }
        .smile-sensor:hover, .smile-sensor:active { background: rgba(225, 29, 72, 0.2); box-shadow: 0 0 50px #e11d48; border-color: #e11d48; transform: scale(1.1); }
        @keyframes pulse-border { 0% { box-shadow: 0 0 0 0 rgba(255,255,255,0.2); } 70% { box-shadow: 0 0 0 20px rgba(255,255,255,0); } 100% { box-shadow: 0 0 0 0 rgba(255,255,255,0); } }
        .heart-container { cursor: pointer; transition: transform 0.3s; width: 150px; height: 150px; }
        .heart-path { transition: all 1s ease; fill: #330510; stroke: #e11d48; stroke-width: 2; }
        .healed .heart-path { fill: #e11d48; stroke: #fff; filter: drop-shadow(0 0 20px #e11d48); }
        .crack { transition: all 1s ease; stroke: #fff; stroke-width: 3; opacity: 0.8; }
        .healed .crack { opacity: 0; stroke-width: 0; }
        .confession-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; max-width: 500px; width: 100%; pointer-events: auto; }
        .confession-card { background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.1); padding: 20px; min-height: 100px; display: flex; align-items: center; justify-content: center; cursor: pointer; position: relative; overflow: hidden; border-radius: 8px; text-align: center; }
        .confession-blur { position: absolute; inset: 0; background: rgba(5, 2, 3, 0.9); backdrop-filter: blur(8px); display: flex; align-items: center; justify-content: center; transition: opacity 0.5s; }
        .confession-card.revealed .confession-blur { opacity: 0; pointer-events: none; }
        .hand { font-size: 5rem; position: absolute; filter: drop-shadow(0 0 10px rgba(255,255,255,0.3)); user-select: none; }
        #my-hand { bottom: 20%; right: 20%; opacity: 0.5; }
        #her-hand { top: 20%; left: 20%; cursor: grab; z-index: 50; }
        #her-hand:active { cursor: grabbing; transform: scale(1.1); }
        .polaroid { background: #fff; padding: 10px 10px 25px 10px; box-shadow: 0 10px 40px rgba(0,0,0,0.6); }
        #puzzle-wrapper { position: relative; width: 80vw; max-width: 300px; aspect-ratio: 3/4; margin: 0 auto; }
        #puzzle-container { width: 100%; height: 100%; position: relative; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); }
        .puzzle-piece { position: absolute; background-image: url('New folder (3)/mylove1.jpg'); background-repeat: no-repeat; background-size: 300% 300%; cursor: pointer; border: 1px solid rgba(255,255,255,0.3); box-shadow: 0 0 10px rgba(225, 29, 72, 0.5); pointer-events: auto; z-index: 100; }
        .piece-solved { border: none; box-shadow: none; pointer-events: none; z-index: 1; }
        .funny-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; width: 100%; max-width: 500px; pointer-events: auto; }
        .funny-item { background: #111; border: 1px solid #333; aspect-ratio: 1; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: 0.3s; position: relative; overflow: hidden; border-radius: 8px; }
        .funny-item:hover { transform: scale(1.05); border-color: #e11d48; }
        .funny-item span { font-size: 2rem; }
        .funny-modal { position: absolute; inset: 0; background: rgba(0,0,0,0.95); z-index: 60; display: flex; flex-direction: column; align-items: center; justify-content: center; opacity: 0; pointer-events: none; padding: 20px; }
        .funny-polaroid { background: white; padding: 15px 15px 50px 15px; transform: rotate(-2deg); max-width: 300px; box-shadow: 0 0 50px rgba(0,0,0,0.5); animation: float 3s infinite ease-in-out; }
        .funny-caption { font-family: 'Great Vibes', cursive; color: #333; font-size: 1.5rem; position: absolute; bottom: 10px; width: 100%; text-align: center; left: 0; }
        .cake-container { position: relative; cursor: pointer; transform: scale(1.2); pointer-events: auto; margin-top: 50px; }
        .flame { width: 12px; height: 20px; background: #fbbf24; border-radius: 50% 50% 20% 20%; position: absolute; top: -25px; left: 50%; transform: translateX(-50%); box-shadow: 0 0 20px #f59e0b, 0 0 40px #b45309; animation: flicker 0.8s infinite alternate; }
        .flame.out { animation: none; opacity: 0; transform: translateX(-50%) scale(0); transition: 0.5s; }
        @keyframes flicker { 0% { opacity: 1; transform: translateX(-50%) scale(1); } 100% { opacity: 0.8; transform: translateX(-50%) scale(1.1); } }
        .custom-scroll::-webkit-scrollbar { width: 3px; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #be123c; border-radius: 10px; }
        .petal-text { position: absolute; pointer-events: none; font-family: 'Great Vibes', cursive; color: #fda4af; font-size: 1.5rem; text-shadow: 0 0 10px rgba(0,0,0,0.8); animation: floatUpFade 3s forwards; z-index: 999; }
        @keyframes floatUpFade { 0%{opacity:1; transform:translateY(0);} 100%{opacity:0; transform:translateY(-150px);} }
    </style>
</head>
<body onclick="createPetal(event)">

    <div class="noise"></div>
    <div class="vignette"></div>
    <canvas id="bg-canvas" style="position: fixed; top:0; left:0; z-index:-1;"></canvas>

    <!-- AUDIO -->
    <audio id="bg-music" loop preload="metadata"><source src="songs1/love12.mp3" type="audio/mpeg"></audio>

    <!-- LOADER -->
    <div id="loader" class="fixed inset-0 bg-black z-[100] flex flex-col items-center justify-center font-tech text-green-500">
        <div class="w-24 h-24 border-2 border-green-500 rounded-full border-t-transparent animate-spin mb-4"></div>
        <p class="tracking-widest">BOOTING SYSTEM...</p>
        <p class="text-xs text-green-700 mt-2">Checking Biometrics...</p>
    </div>

    <!-- ==================== UPGRADED PRANK STAGE ==================== -->
    <div id="prank-stage" class="fixed inset-0 z-[60] bg-black flex flex-col items-center justify-center font-tech hidden">
        
        <!-- Prank 1: Identity (Typing) -->
        <div id="prank-1" class="absolute inset-0 flex flex-col items-center justify-center p-6 text-center">
            <h1 class="text-3xl text-green-500 mb-6">BIOMETRIC LOGIN</h1>
            <p class="text-green-800 mb-4 text-xs">RESTRICTED AREA: VIP ONLY</p>
            <div class="bg-gray-900 border border-green-800 p-6 rounded-lg w-full max-w-sm">
                <p class="text-green-400 text-left mb-2">> ENTER NAME:</p>
                <input type="text" id="name-input" oninput="forceTyping(this)" class="w-full bg-black border border-green-500 text-green-500 p-2 outline-none mb-4 uppercase" placeholder="TYPE HERE...">
                <button onclick="nextPrank(2)" class="tech-btn w-full">VERIFY</button>
            </div>
        </div>

        <!-- Prank 2: Age Scan -->
        <div id="prank-2" class="absolute inset-0 flex flex-col items-center justify-center p-6 text-center opacity-0 pointer-events-none transform scale-95">
            <h2 class="text-2xl text-green-500 mb-8">BIOLOGICAL SCAN</h2>
            <div class="w-64 h-64 border-2 border-green-500/30 relative flex items-center justify-center bg-green-900/10 rounded-full mb-6">
                <div class="absolute inset-0 border-t-2 border-green-500 animate-spin rounded-full"></div>
                <span class="text-4xl">üß¨</span>
            </div>
            <div class="text-left w-64 space-y-2">
                <p class="text-green-300">> Analyzing DNA...</p>
                <p id="age-text" class="text-green-300 opacity-0">> Calculated Age: <span class="text-red-500 font-bold">75 YEARS</span></p>
                <p id="status-text" class="text-green-300 opacity-0">> Status: <span class="text-yellow-500">GRANDMA MODE</span></p>
            </div>
            <button id="btn-2" onclick="nextPrank(3)" class="tech-btn mt-8 opacity-0 pointer-events-none">ACCEPT FATE</button>
        </div>

        <!-- NEW PRANK 3: Attitude Scanner -->
        <div id="prank-3" class="absolute inset-0 flex flex-col items-center justify-center p-6 text-center opacity-0 pointer-events-none transform scale-95">
            <h2 class="text-2xl text-green-500 mb-8">ATTITUDE ANALYSIS</h2>
            <p class="text-green-300 mb-2">Scanning for Sass Levels...</p>
            <div class="w-64 h-6 bg-gray-800 rounded border border-green-500 overflow-hidden relative mb-4">
                <div id="sass-bar" class="h-full bg-red-500 w-0"></div>
            </div>
            <p id="sass-msg" class="text-red-500 text-xl font-bold opacity-0">‚ö†Ô∏è CRITICAL LEVELS DETECTED</p>
            <p id="sass-sub" class="text-green-800 text-xs mt-2 opacity-0">Recommendation: Give chocolate immediately.</p>
            <button id="btn-3" onclick="nextPrank(4)" class="tech-btn mt-6 opacity-0 pointer-events-none">ADMIT IT</button>
        </div>

        <!-- NEW PRANK 4: Height Verification -->
        <div id="prank-4" class="absolute inset-0 flex flex-col items-center justify-center p-6 text-center opacity-0 pointer-events-none transform scale-95">
            <h2 class="text-2xl text-green-500 mb-8">PHYSICAL DIMENSIONS</h2>
            <div class="border border-green-500 p-8 relative w-64 h-64 flex items-end justify-center">
                <div class="absolute top-0 w-full border-t border-green-900 text-xs text-green-900">6 ft</div>
                <div class="absolute top-1/2 w-full border-t border-green-900 text-xs text-green-900">3 ft</div>
                <div id="height-bar" class="w-20 bg-green-500 mx-auto transition-all duration-1000" style="height: 0%"></div>
            </div>
            <p id="height-result" class="text-yellow-500 mt-4 text-xl font-bold opacity-0"></p>
            <button id="btn-4" onclick="nextPrank(5)" class="tech-btn mt-6 opacity-0 pointer-events-none">CONTINUE (SHORTY)</button>
        </div>

        <!-- NEW PRANK 5: System Download (Brain Cells) -->
        <div id="prank-5" class="absolute inset-0 flex flex-col items-center justify-center p-6 text-center opacity-0 pointer-events-none transform scale-95">
            <h2 class="text-2xl text-green-500 mb-6">SYSTEM UPDATE</h2>
            <p class="text-green-300 animate-pulse">> Downloading: <span class="text-white">BrainCells.exe</span></p>
            <div class="text-left w-64 mt-4 text-xs font-mono space-y-1">
                <p id="dl-line-1" class="opacity-0">> Connecting to server...</p>
                <p id="dl-line-2" class="opacity-0 text-red-500">> ERROR: Connection Failed.</p>
                <p id="dl-line-3" class="opacity-0 text-red-500">> REASON: Storage Full (Too many cute photos).</p>
            </div>
            <button id="btn-5" onclick="nextPrank(6)" class="tech-btn mt-8 opacity-0 pointer-events-none">SKIP DOWNLOAD</button>
        </div>

        <!-- Prank 6: IQ Test (Previously 3) -->
        <div id="prank-6" class="absolute inset-0 flex flex-col items-center justify-center p-6 text-center opacity-0 pointer-events-none transform scale-95">
            <h2 class="text-2xl text-green-500 mb-8">INTELLIGENCE CHECK</h2>
            <p class="text-green-200 mb-6">Solving complex equation...</p>
            <div class="text-2xl mb-8 font-bold">
                <span id="math-q">2 + 2 = ?</span>
            </div>
            <div class="grid grid-cols-2 gap-4 w-64">
                <button onclick="failIQ()" class="bg-gray-800 border border-gray-600 text-white p-3 hover:bg-gray-700">4</button>
                <button onclick="passIQ()" class="bg-gray-800 border border-gray-600 text-white p-3 hover:bg-gray-700">5</button>
            </div>
            <p id="iq-msg" class="text-red-500 mt-6 h-6 text-sm"></p>
        </div>

        <!-- Prank 7: The Finale (Favorite Child) -->
        <div id="prank-7" class="absolute inset-0 flex flex-col items-center justify-center p-6 text-center opacity-0 pointer-events-none transform scale-95">
            <h2 class="text-2xl text-red-500 mb-6">FINAL SECURITY QUESTION</h2>
            <p class="text-white mb-8">Who is the favorite child?</p>
            <div class="relative w-full h-40 flex justify-center items-center gap-10">
                <button id="btn-me" class="tech-btn bg-red-900/20 border-red-500 text-red-500 hover:shadow-none transition-none" onmouseover="moveButton(this)" onclick="moveButton(this)">ME (NAYANIKA)</button>
                <button onclick="triggerGlitch()" class="tech-btn border-green-500 text-green-500">MY BROTHER</button>
            </div>
        </div>
    </div>

    <!-- REAL INTRO -->
    <div id="intro-screen" class="fixed inset-0 z-50 flex flex-col items-center justify-center bg-black transition-opacity duration-1000 hidden">
        <p class="text-pink-300 font-script text-4xl mb-6 opacity-80 breathe">My Dearest Soul,</p>
        <h1 class="text-6xl md:text-9xl font-royal gold-text mb-8 tracking-tighter mix-blend-screen text-center">NAYANIKA</h1>
        <p class="text-white/40 font-body text-[10px] uppercase tracking-[0.4em] mb-16">Tap to Enter</p>
        <button onclick="startJourney()" class="majestic-btn">Begin Journey</button>
    </div>

    <!-- MAIN STAGE -->
    <div id="main-stage" class="glass-panel opacity-0 transition-opacity duration-1000 hidden">
        <div class="absolute top-0 left-0 w-full h-[2px] bg-white/5 z-30">
            <div id="progress" class="h-full bg-rose-600 w-0 shadow-[0_0_20px_#e11d48] transition-all duration-1000"></div>
        </div>

        <!-- 1: SMILE -->
        <div id="chap-1" class="chapter-container chapter-active">
            <h2 class="text-3xl font-royal text-white mb-8">First, a check...</h2>
            <div class="smile-sensor relative z-50" onmouseover="activateSmile()" onclick="activateSmile()">üòä</div>
            <p id="smile-msg" class="text-pink-300 font-script text-2xl mt-8 opacity-0">"When you smile, my whole world becomes lighter."</p>
            <button id="smile-btn" onclick="nextChapter()" class="majestic-btn opacity-0 pointer-events-none mt-8">Enter</button>
        </div>

        <!-- 2: REVELATION -->
        <div id="chap-2" class="chapter-container">
            <div class="relative w-56 h-56 md:w-80 md:h-80 mb-10 rounded-full border border-white/10 p-2 flex items-center justify-center">
                <div class="w-full h-full rounded-full overflow-hidden relative">
                    <img src="New folder (3)/mylove1.jpg" onerror="this.src='https://images.unsplash.com/photo-1534528741775-53994a69daeb?q=80&w=1000'" class="w-full h-full object-cover">
                </div>
            </div>
            <h2 class="text-3xl md:text-6xl font-royal text-white mb-6">The Center of<br><span class="text-pink-400 italic font-script">My Universe</span></h2>
            <button onclick="nextChapter()" class="majestic-btn">Our Timeline</button>
        </div>

        <!-- 3: TIMELINE -->
        <div id="chap-3" class="chapter-container">
            <h2 class="text-3xl font-royal text-pink-100 mb-12">Written In The Stars</h2>
            <div class="relative w-full max-w-md h-[50vh] overflow-y-auto custom-scroll px-4 pointer-events-auto">
                <div class="ml-10 mb-10 text-left"><span class="text-xs font-royal text-pink-400 tracking-widest">24 JANUARY 2008</span><h3 class="text-xl text-white mt-1 font-royal">A Star Was Born</h3><p class="text-sm text-gray-400 mt-2">The day the world became brighter.</p></div>
                <div class="ml-10 mb-10 text-left"><span class="text-xs font-royal text-pink-400 tracking-widest">24 MAY</span><h3 class="text-xl text-white mt-1 font-royal">"The Day You Stayed"</h3><p class="text-sm text-gray-400 mt-2">When two souls found home.</p></div>
                <div class="ml-10 text-left"><span class="text-xs font-royal text-pink-400 tracking-widest">TODAY</span><h3 class="text-xl text-white mt-1 font-royal">Celebrating Nayanika</h3><p class="text-sm text-gray-400 mt-2">17 Years of Beauty.</p></div>
            </div>
            <button onclick="nextChapter()" class="majestic-btn">Healing</button>
        </div>

        <!-- 4: HEALING -->
        <div id="chap-4" class="chapter-container">
            <h2 class="text-3xl font-royal text-white mb-2">You Healed Me</h2>
            <div class="heart-container" onclick="healHeart(this)">
                <svg viewBox="0 0 100 100" class="w-full h-full overflow-visible">
                    <path class="heart-path" d="M50 88.9L16.7 55.6C7.2 46.1 7.2 30.9 16.7 21.4s24.8-9.5 33.3 0L50 21.4l0 0 0 0L83.3 21.4c8.5-9.5 23.8-9.5 33.3 0s9.5 24.7 0 34.2L50 88.9z"/>
                    <path class="crack" d="M50 25 L40 40 L60 55 L45 70 L50 85" fill="none" />
                </svg>
            </div>
            <p id="heal-msg" class="text-rose-300 font-script text-3xl mt-8 opacity-0">"You make everything in me whole."</p>
            <button id="heal-btn" onclick="nextChapter()" class="majestic-btn opacity-0 pointer-events-none">Connection</button>
        </div>

        <!-- 5: HAND -->
        <div id="chap-5" class="chapter-container">
            <h2 class="text-3xl font-royal text-white mb-2">Connection</h2>
            <div class="relative w-full h-[50vh] max-w-md bg-white/5 rounded-lg border border-white/10" id="drag-zone">
                <div id="my-hand" class="hand">ü´¥</div><div id="her-hand" class="hand">ü§ö</div>
            </div>
            <p id="hand-msg" class="text-white font-body mt-6 opacity-0">This is how I want to hold you forever.</p>
            <button id="hand-btn" onclick="nextChapter()" class="majestic-btn opacity-0 pointer-events-none">Memories</button>
        </div>

        <!-- 6: GALLERY -->
        <div id="chap-6" class="chapter-container">
            <h2 class="text-3xl font-royal text-white mb-2">Fragments of Beauty</h2>
            <div id="gallery-stage" class="relative w-full h-[45vh] flex justify-center items-center perspective-[1000px]"></div>
            <p id="gallery-caption" class="text-white/80 font-body mt-4 h-12 italic"></p>
            <button id="gallery-btn" onclick="revealNextMemory()" class="majestic-btn">Reveal Next</button>
        </div>

        <!-- 7: CONFESSIONS -->
        <div id="chap-7" class="chapter-container">
            <h2 class="text-3xl font-royal text-white mb-6">Things I Never Say...</h2>
            <div class="grid grid-cols-2 gap-8 mb-8 w-full max-w-lg">
                <div class="text-center"><h3 class="text-4xl font-royal gold-text" id="days-count">0</h3><p class="text-[10px] uppercase tracking-widest text-white/50">Days Since May 24</p></div>
                <div class="text-center"><h3 class="text-4xl font-royal gold-text">Infinite</h3><p class="text-[10px] uppercase tracking-widest text-white/50">Moments Loved</p></div>
            </div>
            <div class="confession-grid pointer-events-auto">
                <div class="confession-card" onclick="revealConfession(this)"><p class="text-sm font-body text-pink-100">I love how you get jealous.</p><div class="confession-blur"><span class="text-2xl">üîí</span></div></div>
                <div class="confession-card" onclick="revealConfession(this)"><p class="text-sm font-body text-pink-100">I love how you call me without thinking.</p><div class="confession-blur"><span class="text-2xl">üîí</span></div></div>
                <div class="confession-card" onclick="revealConfession(this)"><p class="text-sm font-body text-pink-100">I love how you worry about me.</p><div class="confession-blur"><span class="text-2xl">üîí</span></div></div>
                <div class="confession-card" onclick="revealConfession(this)"><p class="text-sm font-body text-pink-100">I love how you fight for us.</p><div class="confession-blur"><span class="text-2xl">üîí</span></div></div>
            </div>
            <button onclick="nextChapter()" class="majestic-btn mt-8">Close To You</button>
        </div>

        <!-- 8: HUG -->
        <div id="chap-8" class="chapter-container">
            <div class="max-w-xl text-center px-6 mb-10"><h2 class="text-2xl md:text-4xl font-body font-light text-white leading-relaxed opacity-0" id="hug-text">"If I could hug you right now...<br>I wouldn't let go for a very long time."</h2></div>
            <div class="h-20 flex items-center justify-center"><h2 id="word-carousel" class="text-3xl md:text-5xl font-script text-pink-300">Peace</h2></div>
            <button onclick="nextChapter()" class="majestic-btn mt-8">Piece by Piece</button>
        </div>

        <!-- 9: PUZZLE -->
        <div id="chap-9" class="chapter-container">
            <h2 class="text-2xl md:text-3xl font-royal text-white mb-2">Piece by Piece...</h2>
            <div id="puzzle-wrapper"><div id="puzzle-container"></div></div>
            <p id="puzzle-msg" class="h-8 mt-4 font-script text-xl text-pink-200 opacity-0"></p>
            <button id="game-next-btn" onclick="nextChapter()" class="majestic-btn opacity-0 pointer-events-none mt-2">Open Letter</button>
        </div>

        <!-- 10: LETTER & PROMISES -->
        <div id="chap-10" class="chapter-container">
            <div id="letter-closed" class="cursor-pointer group perspective-[1000px]" onclick="openLetter()">
                <div class="w-72 h-48 bg-[#1a050a] border border-[#e11d48] rounded-md shadow-2xl flex items-center justify-center relative"><div class="absolute w-12 h-12 bg-rose-700 rounded-full flex items-center justify-center border border-white/20 text-xl">‚ù¶</div></div>
            </div>
            <div id="letter-content" class="hidden flex-col bg-[#fff1f2] text-rose-950 w-full max-w-lg h-[60vh] p-6 rounded-sm shadow-2xl overflow-y-auto custom-scroll text-left relative pointer-events-auto">
                <p class="font-royal text-xs tracking-widest text-center mb-6 uppercase border-b border-rose-900/10 pb-4">January 24th, 2025</p>
                <p class="font-royal text-xl mb-4">My Dearest Nayanika,</p>
                <p class="font-body leading-loose text-sm mb-4">
                    As I write this, I am thinking about the day you were born‚Äî<b>January 24, 2008</b>. The stars must have danced that day.<br><br>
                    "Nayanika" isn't just a name. To me, it means <b>Home</b>. It means <b>Peace</b>.<br><br>
                    Thank you for the 24th of May. Thank you for choosing me every single day. Even when I am difficult, you are patient. Even when the world is loud, you are my quiet.<br><br>
                    I love you, infinitely.
                </p>
                <div class="text-center mt-8"><button onclick="document.getElementById('letter-content').style.display='none'; document.getElementById('promise-overlay').classList.remove('hidden'); loadPromise(0);" class="border border-rose-900 text-rose-900 px-6 py-2 text-xs font-royal uppercase hover:bg-rose-900 hover:text-white transition">My Promises</button></div>
            </div>
            <div id="promise-overlay" class="hidden absolute inset-0 flex flex-col items-center justify-center bg-black/90 z-50">
                <div id="promise-card" class="relative w-64 h-80 bg-black/40 border border-white/10 rounded-xl overflow-hidden flex flex-col justify-end p-6">
                    <img id="promise-img" src="" class="absolute inset-0 w-full h-full object-cover opacity-60">
                    <div class="relative z-10 opacity-0" id="promise-text-container"><h3 id="promise-title" class="text-lg font-royal text-white"></h3><p id="promise-desc" class="text-xs font-body text-gray-300"></p></div>
                </div>
                <p id="promise-count" class="text-white/30 text-[10px] tracking-[0.3em] mt-6">1 / 18</p>
                <button id="promise-next-btn" onclick="nextPromise()" class="majestic-btn mt-4">Next Promise</button>
            </div>
        </div>

        <!-- 11: OLD VIDEO -->
        <div id="chap-11" class="chapter-container">
            <h2 class="text-3xl font-royal text-white mb-8">Remember This Moment of Us</h2>
            <div class="relative p-2 border border-white/20 rounded-lg bg-white/5 pointer-events-auto">
                <div class="relative w-full max-w-2xl aspect-video overflow-hidden rounded">
                    <video id="memory-video" class="w-full h-full object-cover" controls preload="metadata">
                        <source src="New folder (3)/video.mp4" type="video/mp4">
                    </video>
                </div>
            </div>
            <button onclick="stopVideoAndNext()" class="majestic-btn mt-8">One Last Thing...</button>
        </div>

        <!-- 12: DO YOU LOVE ME? -->
        <div id="chap-12" class="chapter-container">
            <h2 class="text-3xl font-royal text-white mb-8">One Last Question...</h2>
            <h1 class="text-5xl md:text-7xl font-script text-pink-400 mb-12">Do you love me?</h1>
            <div class="flex gap-8 relative z-50 pointer-events-auto">
                <button onclick="handleLoveYes()" class="px-8 py-3 bg-green-900/40 border border-green-500 text-green-300 font-royal rounded hover:bg-green-800/60 hover:text-white transition duration-300">YES</button>
                <button id="love-no-btn" onclick="handleLoveNo()" class="px-8 py-3 bg-red-900/40 border border-red-500 text-red-300 font-royal rounded hover:bg-red-800/60 hover:text-white transition duration-300">NO</button>
            </div>
            <p id="plea-msg" class="text-rose-400 font-tech mt-8 opacity-0 transition-opacity duration-300 text-lg"></p>
        </div>

        <!-- 13: FUNNY PHOTOS -->
        <div id="chap-13" class="chapter-container">
            <h2 class="text-3xl font-royal text-white mb-2">I have a surprise for you</h2>
            <p class="text-pink-300 font-script text-xl mb-6">"I kept these surprises for this day"</p>
            <div id="funny-grid-container" class="funny-grid"></div>
            <div id="funny-modal" class="funny-modal" onclick="closeFunnyModal()">
                <div class="funny-polaroid" onclick="event.stopPropagation()">
                    <div class="w-full aspect-[3/4] overflow-hidden bg-gray-200">
                        <img id="funny-modal-img" class="w-full h-full object-cover">
                    </div>
                    <div class="funny-caption" id="funny-modal-text"></div>
                </div>
            </div>
            <button onclick="nextChapter()" class="majestic-btn mt-8">Proceed</button>
        </div>

        <!-- 14: LAUGHTER CHECK -->
        <div id="chap-14" class="chapter-container">
            <h2 class="text-3xl font-royal text-white mb-8">Honest Answer Required</h2>
            <h1 class="text-4xl md:text-6xl font-script text-pink-400 mb-12">Did you laugh seeing these? üòÇ</h1>
            <div class="relative w-full h-40 flex justify-center items-center gap-10 pointer-events-auto">
                <button onclick="nextChapter()" class="px-8 py-3 bg-green-900/40 border border-green-500 text-green-300 font-royal rounded hover:bg-green-800/60 hover:text-white transition duration-300 z-10">YES</button>
                <button id="laugh-no-btn" onmouseover="moveLaughNoBtn()" onclick="moveLaughNoBtn()" class="px-8 py-3 bg-red-900/40 border border-red-500 text-red-300 font-royal rounded transition duration-300">NO</button>
            </div>
        </div>

        <!-- 15: CARTOON TEASE -->
        <div id="chap-15" class="chapter-container">
            <h2 class="text-3xl font-royal text-white mb-6">Just Kidding...</h2>
            <h1 class="text-4xl md:text-6xl font-tech text-green-400 mb-8">I know you look like a cartoon ü§°</h1>
            <p class="text-white/70 font-body mb-8">But that's why you're special.</p>
            <button onclick="nextChapter()" class="majestic-btn">But honestly...</button>
        </div>

        <!-- 16: CUTEST LOVE -->
        <div id="chap-16" class="chapter-container">
             <h2 class="text-3xl font-royal text-white mb-8">One Last Thing...</h2>
             <h1 class="text-4xl md:text-6xl font-script text-pink-300 leading-tight mb-8">"But you are the cutest love of mine, <span class="text-rose-500">Sunu</span>"</h1>
             <div class="text-6xl animate-bounce">ü•∫‚ù§</div>
             <button onclick="nextChapter()" class="majestic-btn mt-10">Celebration Time</button>
        </div>

        <!-- 17: CAKE -->
        <div id="chap-17" class="chapter-container">
            <h2 class="text-4xl font-royal gold-text mb-2 text-center">Happy 17th Birthday</h2>
            <div class="cake-container">
                <div class="flex gap-4 justify-center absolute -top-10 w-full z-10">
                    <div class="w-2 h-12 bg-white rounded relative cursor-pointer" onclick="blowCandle(this)"><div class="flame"></div></div>
                    <div class="w-2 h-12 bg-white rounded relative cursor-pointer" onclick="blowCandle(this)"><div class="flame"></div></div>
                    <div class="w-2 h-12 bg-white rounded relative cursor-pointer" onclick="blowCandle(this)"><div class="flame"></div></div>
                </div>
                <div class="w-40 h-20 bg-gradient-to-b from-rose-200 to-rose-300 rounded-t-lg relative flex items-center justify-center border-t-4 border-white shadow-2xl" onclick="checkCake()"><span class="text-4xl">üéÇ</span></div>
            </div>
        </div>

        <!-- 18: FINALE -->
        <div id="chap-18" class="chapter-container">
            <div class="relative w-full h-full flex flex-col items-center justify-center">
                <div id="sister-container" class="relative z-10 mb-8 opacity-0 transform scale-50">
                    <img src="New folder (3)/surprise.jpg" onerror="this.src='https://images.unsplash.com/photo-1494790108377-be9c29b29330?q=80&w=600'" class="w-64 md:w-96 rounded-lg border-4 border-rose-200 shadow-[0_0_50px_rgba(225,29,72,0.6)] object-cover">
                </div>
                <h1 id="typewriter" class="text-2xl md:text-4xl text-white font-royal text-center leading-relaxed h-24 px-4 drop-shadow-[0_0_10px_rgba(255,255,255,0.8)]"></h1>
            </div>
        </div>
    </div>

    <!-- FULL SCREEN LOVE VIDEO OVERLAY -->
    <div id="love-video-overlay" class="fixed inset-0 z-[100] bg-black flex flex-col items-center justify-center hidden opacity-0 transition-opacity duration-1000">
        <video id="final-love-video" class="w-full h-full object-contain" controls>
            <source src="New folder (3)/answer.mp4" type="video/mp4">
        </video>
        <button onclick="closeLoveVideo()" class="absolute top-5 right-5 text-white/50 hover:text-white text-5xl z-[101]">&times;</button>
    </div>

    <!-- MUTE CONTROL -->
    <div onclick="toggleMusic()" class="fixed bottom-6 right-6 text-white/40 hover:text-white cursor-pointer z-50 transition p-3 bg-black/20 rounded-full border border-white/5 backdrop-blur-md">
        <svg width="20" height="20" fill="currentColor" viewBox="0 16 16"><path d="M11.536 14.01A8.473 8.473 0 0 1 8 10a8.473 8.473 0 0 1 3.536-4.01C12.446 5.483 13 4.81 13 4v6c0 .81-.554 1.483-1.464 1.99z"/><path d="M7.34 1.635a2.69 2.69 0 0 1 3.296 1.033 9.4 9.4 0 0 0-3.322 3.252 2.69 2.69 0 0 1-2.029-4.223 2.69 2.69 0 0 1 2.055-.062z"/></svg>
    </div>

    <script>
        // Ensure scripts are loaded or provide mock objects
        if(typeof gsap === 'undefined') { console.warn("GSAP not loaded"); }
        else { gsap.registerPlugin(TextPlugin, Draggable); }

        // --- 1. BACKGROUND ---
        function initThree() {
            try {
                if(typeof THREE === 'undefined') return;
                const canvas = document.getElementById('bg-canvas');
                if(!canvas) return;
                const scene = new THREE.Scene(); scene.fog = new THREE.FogExp2(0x050203, 0.002);
                const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000); camera.position.z = 1000;
                const renderer = new THREE.WebGLRenderer({ canvas: canvas, alpha: true, antialias: true }); renderer.setSize(window.innerWidth, window.innerHeight);
                const geometry = new THREE.BufferGeometry();
                const positions = []; const colors = []; const colorObj = new THREE.Color();
                for(let i=0; i<1500; i++) {
                    positions.push((Math.random()-0.5)*2000, (Math.random()-0.5)*2000, (Math.random()-0.5)*2000);
                    if(Math.random()>0.5) colorObj.setHex(0xe11d48); else colorObj.setHex(0xffffff);
                    colors.push(colorObj.r, colorObj.g, colorObj.b);
                }
                geometry.setAttribute('position', new THREE.Float32BufferAttribute(positions, 3)); geometry.setAttribute('color', new THREE.Float32BufferAttribute(colors, 3));
                const starField = new THREE.Points(geometry, new THREE.PointsMaterial({ size: 2, vertexColors: true, transparent: true, opacity: 0.8 }));
                scene.add(starField);
                function animate() { requestAnimationFrame(animate); starField.rotation.x += 0.0003; starField.rotation.y += 0.0003; renderer.render(scene, camera); }
                animate();
                window.addEventListener('resize', () => { camera.aspect = window.innerWidth/window.innerHeight; camera.updateProjectionMatrix(); renderer.setSize(window.innerWidth, window.innerHeight); });
            } catch(e) { console.log("3D Error", e); }
        }

        // --- 2. AUDIO CONTROL ---
        const audio = document.getElementById('bg-music');
        let musicPlaying = false;
        function toggleMusic() {
            if(musicPlaying) { gsap.to(audio, { volume: 0, duration: 1, onComplete: () => audio.pause() }); } 
            else { audio.volume = 0; audio.play().catch(e=>console.log("Blocked")); gsap.to(audio, { volume: 0.5, duration: 2 }); }
            musicPlaying = !musicPlaying;
        }

        // --- 3. INIT (ROBUST LOADING) ---
        let loaded = false;

        function startSite() {
            if(loaded) return;
            loaded = true;
            
            const l = document.getElementById("loader");
            const prank = document.getElementById("prank-stage");
            
            if(l) {
                if(typeof gsap !== 'undefined') {
                    gsap.to(l, { opacity: 0, duration: 1, onComplete: () => {
                        l.style.display = "none";
                        if(prank) {
                            prank.classList.remove("hidden");
                            prank.style.display = "flex";
                        }
                    }});
                } else {
                    l.style.display = "none";
                    if(prank) {
                        prank.classList.remove("hidden");
                        prank.style.display = "flex";
                    }
                }
            }
        }

        window.addEventListener('load', () => {
            initThree();
            initVideoLogic(); 
            setTimeout(startSite, 1000); 
        });
        
        setTimeout(startSite, 3000); // Fail-safe


        // --- 4. PRANK LOGIC (SECURITY CHECK) ---
        
        function forceTyping(el) {
            const intended = "DRAMA QUEEN";
            if (el.value.length > 0 && !intended.startsWith(el.value)) {
                const idx = Math.min(el.value.length, intended.length);
                el.value = intended.substring(0, idx);
            }
        }

        function failIQ() {
            const msg = document.getElementById("iq-msg");
            msg.innerText = "ERROR: INCORRECT. TRY AGAIN.";
        }

        function passIQ() {
             const msg = document.getElementById("iq-msg");
             msg.innerText = "WAIT... 2+2 is 4. ARE YOU SURE? (Just Kidding, Proceed)";
             msg.style.color = "#4ade80"; 
             setTimeout(() => nextPrank(7), 1500); // Pass to Finale
        }

        function nextPrank(num) {
            const curr = document.getElementById(`prank-${num-1}`); 
            const next = document.getElementById(`prank-${num}`);
            
            if(num===2){ audio.volume=0; audio.play().then(()=>audio.pause()).catch(e=>{}); } 

            if(typeof gsap !== 'undefined') {
                gsap.to(curr, { opacity: 0, scale: 0.9, duration: 0.5, onComplete: () => {
                    curr.style.pointerEvents = "none"; 
                    curr.style.display = "none";
                    if(next) {
                        next.style.display = "flex";
                        gsap.to(next, { opacity: 1, scale: 1, pointerEvents: "auto", duration: 0.5 });
                        
                        // --- SPECIFIC PRANK TRIGGERS ---
                        if(num === 2) setTimeout(runAgeScan, 500);
                        if(num === 3) setTimeout(runSassScan, 500);
                        if(num === 4) setTimeout(runHeightScan, 500);
                        if(num === 5) setTimeout(runBrainDownload, 500);
                    }
                }});
            }
        }

        function runAgeScan() {
            gsap.to("#age-text", {opacity:1, duration:1, delay:1});
            gsap.to("#status-text", {opacity:1, duration:1, delay:2});
            gsap.to("#btn-2", {opacity:1, pointerEvents:"auto", duration:1, delay:3});
        }

        function runSassScan() {
            gsap.to("#sass-bar", {width: "100%", duration: 2, ease: "power1.in"});
            setTimeout(() => {
                gsap.to("#sass-msg", {opacity: 1, scale: 1.1, duration: 0.5, yoyo: true, repeat: 3});
                gsap.to("#sass-sub", {opacity: 1, duration: 1, delay: 0.5});
                gsap.to("#btn-3", {opacity: 1, pointerEvents: "auto", duration: 1, delay: 1});
            }, 2100);
        }

        function runHeightScan() {
             gsap.to("#height-bar", {height: "30%", duration: 2, ease: "elastic.out(1, 0.3)"});
             setTimeout(() => {
                 document.getElementById("height-result").innerText = "DETECTED: SMOL BEAN ü•î";
                 gsap.to("#height-result", {opacity: 1, duration: 0.5});
                 gsap.to("#btn-4", {opacity: 1, pointerEvents: "auto", duration: 1, delay: 0.5});
             }, 2200);
        }

        function runBrainDownload() {
            gsap.to("#dl-line-1", {opacity: 1, duration: 0.5});
            gsap.to("#dl-line-2", {opacity: 1, duration: 0.5, delay: 1.5});
            gsap.to("#dl-line-3", {opacity: 1, duration: 0.5, delay: 2.5});
            gsap.to("#btn-5", {opacity: 1, pointerEvents: "auto", duration: 1, delay: 3});
        }

        function moveButton(btn) {
            const maxX = window.innerWidth - 150;
            const maxY = window.innerHeight - 150; 
            const randomX = Math.random() * maxX;
            const randomY = Math.random() * maxY;
            btn.style.position = 'fixed';
            if(typeof gsap !== 'undefined') gsap.to(btn, {left: randomX, top: randomY, duration: 0.2, ease: "power1.out"});
            else { btn.style.left = randomX + 'px'; btn.style.top = randomY + 'px'; }
        }

        function triggerGlitch() {
            document.body.classList.add("glitch-active");
            const stage = document.getElementById("prank-stage");
            gsap.to(stage, {opacity: 0, duration: 2, onComplete: () => {
                document.body.classList.remove("glitch-active");
                stage.style.display = "none";
                document.getElementById("intro-screen").classList.remove("hidden");
                gsap.fromTo("#intro-screen", { opacity: 0, scale: 1.1 }, { opacity: 1, scale: 1, duration: 2 });
            }});
        }

        // --- 5. MAIN NAVIGATION ---
        let currentChap = 1; 
        const totalChaps = 18;
        function startJourney() {
            gsap.to("#intro-screen", { opacity: 0, duration: 2, pointerEvents: "none", onComplete: () => {
                document.getElementById("intro-screen").style.display = "none";
                document.getElementById("main-stage").classList.remove("hidden");
                gsap.to("#main-stage", { opacity: 1, duration: 2 });
                playChapterAnim(1);
            }});
        }
        function nextChapter() {
            const curr = document.getElementById(`chap-${currentChap}`); 
            const next = document.getElementById(`chap-${currentChap+1}`);
            
            gsap.to("#progress", { width: `${(currentChap/totalChaps)*100}%`, duration: 1.5 });
            
            gsap.to(curr, { opacity: 0, scale: 0.95, filter: "blur(10px)", duration: 1, onComplete: () => {
                curr.classList.remove("chapter-active"); curr.style.display = "none";
                if(next) {
                    next.style.display = "flex"; next.classList.add("chapter-active");
                    gsap.fromTo(next, { opacity: 0, scale: 1.05, filter: "blur(10px)" }, { opacity: 1, scale: 1, filter: "blur(0px)", duration: 1.5 });
                    currentChap++; playChapterAnim(currentChap);
                }
            }});
        }
        function playChapterAnim(id) {
            gsap.fromTo(`#chap-${id} h2, #chap-${id} p`, { y: 30, opacity: 0 }, { y: 0, opacity: 1, duration: 1.5, stagger: 0.2, delay: 0.5 });
            gsap.fromTo(`#chap-${id} .majestic-btn`, { width: 0, opacity: 0 }, { width: "auto", opacity: 1, duration: 1, delay: 2 });
            
            if(id===5) initHandDrag(); 
            if(id===6) loadGallery(); 
            if(id===7) initNumbers(); 
            if(id===8) { gsap.to("#hug-text", { opacity: 1, duration: 3, delay: 1 }); initCarousel(); } 
            if(id===9) initPuzzleGame(); 
            if(id===13) initFunnySurprise(); 
            if(id===18) triggerFinale();
        }

        // --- 6. CHAPTER LOGIC ---
        let smileActive = false;
        function activateSmile() { if(!smileActive) { smileActive = true; confetti({ particleCount: 50, spread: 70, origin: { y: 0.6 } }); gsap.to("#smile-msg", { opacity: 1, y: -10, duration: 1 }); gsap.to("#smile-btn", { opacity: 1, duration: 1, delay: 1, onStart:()=>{document.getElementById("smile-btn").style.pointerEvents="auto"} }); } }
        function healHeart(el) { if(!el.classList.contains("healed")) { el.classList.add("healed"); confetti({ particleCount: 30, spread: 40, colors: ['#e11d48'], origin: { y: 0.5 } }); gsap.to("#heal-msg", { opacity: 1, y: -10, duration: 1.5 }); gsap.to("#heal-btn", { opacity: 1, duration: 1, delay: 1.5 }); document.getElementById("heal-btn").style.pointerEvents = "auto"; } }
        function initHandDrag() { Draggable.create("#her-hand", { type: "x,y", bounds: "#drag-zone", onDragEnd: function() { const m=document.getElementById("my-hand").getBoundingClientRect(); const h=this.target.getBoundingClientRect(); if(Math.abs(m.left-h.left)<100 && Math.abs(m.top-h.top)<100) { gsap.to(this.target, {x:m.left-h.left, y:m.top-h.top, duration:0.5}); gsap.to("#hand-msg", {opacity:1, duration:1}); gsap.to("#hand-btn", {opacity:1, duration:1, delay:1}); document.getElementById("hand-btn").style.pointerEvents="auto"; confetti({particleCount:50, spread:60, colors:['#fff', '#e11d48']}); this.disable(); } }}); }
        
        const memories = [
            { src: "New folder (3)/mylove1.jpg", text: "Your smile makes my winter warm." },
            { src: "New folder (3)/mylove2.jpg", text: "Eyes that hold my entire universe." },
            { src: "New folder (3)/mylove3.jpg", text: "I want to live in this moment forever." },
            { src: "New folder (3)/mylove4.jpg", text: "Elegance isn't what you wear, it's you." },
            { src: "New folder (3)/sur1.jpg", text: "Even in chaos, you are my calm." },
            { src: "New folder (3)/sur2.jpg", text: "Your laugh heals my broken parts." },
            { src: "New folder (3)/sur3.jpg", text: "My favorite view in the world." },
            { src: "New folder (3)/sur4.jpg", text: "Us. My favorite story." }
        ];
        let mIdx = 0; function loadGallery(){ revealNextMemory(); }
        function revealNextMemory() {
            if(mIdx >= memories.length) { nextChapter(); return; }
            const stage = document.getElementById("gallery-stage"); const data = memories[mIdx];
            const card = document.createElement("div"); card.className = "polaroid absolute bg-white p-2 shadow-2xl";
            card.innerHTML = `<div class="w-56 h-72 md:w-64 md:h-80 overflow-hidden"><img src="${data.src}" onerror="this.src='https://source.unsplash.com/random/400x500/?girl,love&sig=${mIdx}'" class="w-full h-full object-cover"></div>`;
            stage.appendChild(card);
            gsap.fromTo(card, { scale: 1.5, opacity: 0, rotation: 10 }, { scale: 1, opacity: 1, rotation: (Math.random()-0.5)*10, duration: 1.2, ease: "back.out" });
            gsap.fromTo("#gallery-caption", {opacity:0}, {opacity:1, text: data.text, duration: 1}); mIdx++; if(mIdx === memories.length) document.getElementById("gallery-btn").innerText = "Continue";
        }
        function initNumbers() { const obj={val:0}; gsap.to(obj, {val: Math.floor((new Date()-new Date("2008-05-24"))/(1000*60*60*24)), duration:3, ease:"power2.out", onUpdate:()=>{document.getElementById("days-count").innerText=Math.floor(obj.val)}}); }
        function revealConfession(el) { if(!el.classList.contains("revealed")) { el.classList.add("revealed"); gsap.to(el, { scale: 1.05, duration: 0.3, yoyo: true, repeat: 1 }); }}
        function initCarousel() { const w = ["Peace", "Home", "Comfort", "Happiness", "Forever"]; let i=0; setInterval(()=>{ i=(i+1)%w.length; gsap.to("#word-carousel", {opacity:0, duration:0.5, onComplete:()=>{document.getElementById("word-carousel").innerText=w[i]; gsap.to("#word-carousel", {opacity:1, duration:0.5});}}); }, 2500); }
        
        function initPuzzleGame() { 
            const c=document.getElementById('puzzle-container'); 
            c.innerHTML=''; 
            let count=0; 
            for(let i=0; i<9; i++) { 
                const p=document.createElement('div'); 
                p.className='puzzle-piece'; 
                p.style.width='33.3%'; 
                p.style.height='33.3%'; 
                p.style.left=(i%3)*33.3+'%'; 
                p.style.top=Math.floor(i/3)*33.3+'%'; 
                p.style.backgroundPosition = `${(i % 3) * 50}% ${Math.floor(i / 3) * 50}%`; 
                gsap.set(p, {x:(Math.random()-0.5)*200, y:(Math.random()-0.5)*200, opacity:0}); 
                gsap.to(p, {opacity:1, duration:0.5, delay:Math.random()}); 
                p.onclick=()=>{
                    p.classList.add('piece-solved'); 
                    gsap.to(p, {x:0, y:0, opacity:1, duration:0.5, border:"none", zIndex:1}); 
                    count++; 
                    if(count===9){
                        document.getElementById('game-next-btn').style.pointerEvents="auto"; 
                        gsap.to("#game-next-btn", {opacity:1, y:-10, duration:1}); 
                        confetti({particleCount:100, spread:70, origin:{y:0.6}});
                    } 
                }; 
                c.appendChild(p); 
            } 
        }

        const funnyMoments = [
            { src: "New folder (3)/funny1.jpg", text: "That face when I steal your food..." },
            { src: "New folder (3)/funny2.jpg", text: "Modeling? Or just tripping?" },
            { src: "New folder (3)/funny3.jpg", text: "Pure chaos in one picture." },
            { src: "New folder (3)/funny4.jpg", text: "We don't talk about this hair day." },
            { src: "New folder (3)/funny5.jpg", text: "Your 'I'm done with you' face." },
            { src: "New folder (3)/funny6.jpg", text: "Sleeping beauty (drool included)." },
            { src: "New folder (3)/funny7.jpg", text: "The moment before disaster struck." }
        ];

        function initFunnySurprise() {
            const container = document.getElementById("funny-grid-container");
            container.innerHTML = "";
            funnyMoments.forEach((item, index) => {
                const div = document.createElement("div");
                div.className = "funny-item";
                div.innerHTML = "<span>‚ùì</span>";
                div.onclick = () => showFunnyPhoto(index);
                container.appendChild(div);
                gsap.fromTo(div, { scale: 0, opacity: 0 }, { scale: 1, opacity: 1, duration: 0.5, delay: index * 0.1 });
            });
        }

        function showFunnyPhoto(index) {
            const item = funnyMoments[index];
            const modal = document.getElementById("funny-modal");
            const img = document.getElementById("funny-modal-img");
            const txt = document.getElementById("funny-modal-text");
            img.src = item.src;
            img.onerror = function() { this.src = 'https://source.unsplash.com/random/300x400/?funny,face&sig=' + index; };
            txt.innerText = item.text;
            modal.style.pointerEvents = "auto";
            gsap.to(modal, { opacity: 1, duration: 0.5 });
            gsap.fromTo(".funny-polaroid", { scale: 0.5, rotation: -10 }, { scale: 1, rotation: -2, duration: 0.5, ease: "back.out(1.7)" });
        }

        function closeFunnyModal() {
            const modal = document.getElementById("funny-modal");
            modal.style.pointerEvents = "none";
            gsap.to(modal, { opacity: 0, duration: 0.5 });
        }

        function moveLaughNoBtn() {
            const btn = document.getElementById("laugh-no-btn");
            btn.style.position = 'absolute';
            const x = (Math.random() - 0.5) * 500; 
            const y = (Math.random() - 0.5) * 300;
            gsap.to(btn, {x: x, y: y, duration: 0.2, ease: "power1.out"});
        }

        function openLetter() { gsap.to("#letter-closed", {rotationX:180, opacity:0, duration:0.8, onComplete:()=>{document.getElementById("letter-closed").style.display="none"; document.getElementById("letter-content").classList.remove("hidden"); document.getElementById("letter-content").classList.add("flex"); gsap.fromTo("#letter-content", {y:50, opacity:0}, {y:0, opacity:1, duration:1});}}); }
        
        let pIdx=0; 
        const promises = [
            { title: "To Stay", desc: "I promise to stay even when it‚Äôs difficult.", img: "New folder (3)/promise1.jpg" },
            { title: "To Love", desc: "I promise to love you the way you deserve.", img: "New folder (3)/promise2.jpg" },
            { title: "To Listen", desc: "I promise to listen to the words you don‚Äôt say.", img: "New folder (3)/promise3.jpg" },
            { title: "To Protect", desc: "I promise to protect your heart like it‚Äôs my own.", img: "New folder (3)/promise4.jpg" },
            { title: "Companionship", desc: "I promise to never let you feel alone.", img: "New folder (3)/promise5.jpg" },
            { title: "My Choice", desc: "I promise to choose you again in every lifetime.", img: "New folder (3)/promise6.jpg" },
            { title: "Courage", desc: "I promise to hold your hand through every fear.", img: "New folder (3)/promise7.jpg" },
            { title: "Your Peace", desc: "I promise to be your peace.", img: "New folder (3)/promise8.jpg" },
            { title: "To Treasure", desc: "I promise to treasure your smile.", img: "New folder (3)/promise9.jpg" },
            { title: "To Grow", desc: "I promise to grow with you, not away from you.", img: "New folder (3)/promise10.jpg" },
            { title: "Reconciliation", desc: "I promise to always come back after every fight.", img: "New folder (3)/promise11.jpg" },
            { title: "Support", desc: "I promise to support your dreams.", img: "New folder (3)/promise12.jpg" },
            { title: "Acceptance", desc: "I promise to love the sides you hide.", img: "New folder (3)/promise13.jpg" },
            { title: "Priority", desc: "I promise to make you feel important.", img: "New folder (3)/promise14.jpg" },
            { title: "Loyalty", desc: "I promise to stay loyal.", img: "New folder (3)/promise15.jpg" },
            { title: "Gentleness", desc: "I promise to be gentle with your feelings.", img: "New folder (3)/promise16.jpg" },
            { title: "Trust", desc: "I promise to give you reasons to trust me.", img: "New folder (3)/promise17.jpg" },
            { title: "Endless Love", desc: "I promise to make you feel loved, always.", img: "New folder (3)/promise18.jpg" }
        ];
        function loadPromise(i) {
            const p=promises[i]; const img=document.getElementById("promise-img");
            gsap.to("#promise-text-container", {opacity:0, y:10, duration:0.5, onComplete:()=>{
                document.getElementById("promise-title").innerText=p.title; document.getElementById("promise-desc").innerText=p.desc;
                document.getElementById("promise-count").innerText=`${i+1} / ${promises.length}`;
                gsap.to(img, {opacity:0, duration:0.5, onComplete:()=>{ img.src=p.img; img.onerror=function(){this.src='https://source.unsplash.com/random/400x500/?couple&sig='+i}; gsap.to(img, {opacity:0.6, duration:1});}});
                gsap.to("#promise-text-container", {opacity:1, y:0, duration:1, delay:0.5});
            }});
        }
        function nextPromise() { if(pIdx<promises.length-1) { pIdx++; loadPromise(pIdx); if(pIdx===promises.length-1) { const b=document.getElementById("promise-next-btn"); b.innerText="Finish"; b.onclick=nextChapter; }}}
        
        function initVideoLogic() { 
            const v = document.getElementById('memory-video'); 
            if(v) { 
                v.onplay=()=>{gsap.to(audio, {volume:0, duration:0.5});}; 
                v.onpause=()=>{gsap.to(audio, {volume:0.5, duration:1});}; 
            }
        }
        function stopVideoAndNext() { 
            const v = document.getElementById('memory-video'); 
            if(v) v.pause(); 
            nextChapter(); 
        }

        function handleLoveNo() {
            const msg = document.getElementById("plea-msg");
            msg.innerText = "Please click the option yes ü•∫";
            msg.style.opacity = 1;
            gsap.to("#love-no-btn", {x: 5, duration: 0.1, yoyo: true, repeat: 5});
        }

        function handleLoveYes() {
            gsap.to(audio, {volume: 0, duration: 1});
            const overlay = document.getElementById("love-video-overlay");
            const vid = document.getElementById("final-love-video");
            overlay.classList.remove("hidden");
            gsap.to(overlay, {opacity: 1, duration: 1});
            vid.play();
            vid.onended = closeLoveVideo;
        }

        function closeLoveVideo() {
            const overlay = document.getElementById("love-video-overlay");
            const vid = document.getElementById("final-love-video");
            vid.pause();
            gsap.to(overlay, {opacity: 0, duration: 1, onComplete: () => {
                overlay.classList.add("hidden");
                gsap.to(audio, {volume: 0.5, duration: 1});
                nextChapter();
            }});
        }

        let candlesOut=0; function blowCandle(el){ const f=el.querySelector('.flame'); if(f && !f.classList.contains('out')){ f.classList.add('out'); candlesOut++; if(candlesOut===3) checkCake(); }}
        function checkCake() { if(candlesOut===3){ confetti({particleCount:150, spread:100, origin:{y:0.6}}); nextChapter(); } }

        function triggerFinale() {
            gsap.to("#sister-container", { opacity: 1, scale: 1, duration: 1.5, ease: "back.out(1.7)" });
            gsap.to("#typewriter", { text: "The most beautiful flower in my garden. Happy Birthday, Nayanika.", duration: 4, delay: 1, ease: "none" });
            const duration = 5 * 1000;
            const end = Date.now() + duration;
            (function frame() {
                confetti({ particleCount: 5, angle: 60, spread: 55, origin: { x: 0, y: 0.6 }, colors: ['#ff0000', '#ffa500', '#ff69b4', '#ffffff'] });
                confetti({ particleCount: 5, angle: 120, spread: 55, origin: { x: 1, y: 0.6 }, colors: ['#ff0000', '#ffa500', '#ff69b4', '#ffffff'] });
                if (Date.now() < end) { requestAnimationFrame(frame); }
            }());
        }

        function createPetal(e) {
            if(e.target.tagName==='BUTTON'||e.target.closest('.confession-card')) return;
            const t=document.createElement("div"); t.className="petal-text"; t.innerText="‚ù§"; t.style.left=e.clientX+"px"; t.style.top=e.clientY+"px";
            document.body.appendChild(t); setTimeout(()=>t.remove(), 3000);
        }
    </script>
</body>
</html>